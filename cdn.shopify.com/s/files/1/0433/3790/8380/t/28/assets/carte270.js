class CartRemoveButton extends HTMLElement{constructor(){super();this.addEventListener("click",t=>{t.preventDefault(),this.closest("cart-items").updateQuantity(this.dataset.index,0)})}}customElements.define("cart-remove-button",CartRemoveButton);class CartItems extends HTMLElement{constructor(){super();this.lineItemStatusElement=document.getElementById("shopping-cart-line-item-status"),this.currentItemCount=Array.from(this.querySelectorAll('[name="updates[]"]')).reduce((t,e)=>t+parseInt(e.value),0),this.debouncedOnChange=debounce(t=>{this.onChange(t)},300),this.addEventListener("change",this.debouncedOnChange.bind(this))}onChange(t){this.updateQuantity(t.target.dataset.index,t.target.value,document.activeElement.getAttribute("name"))}getSectionsToRender(){return[{id:"main-cart-items",section:document.getElementById("main-cart-items").dataset.id,selector:".js-contents"},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"cart-notification",section:"cart-notification-product",selector:".shopify-section"},{id:"cart-live-region-text",section:"cart-live-region-text",selector:".shopify-section"},{id:"main-cart-footer",section:document.getElementById("main-cart-footer").dataset.id,selector:".js-contents"}]}updateQuantity(t,e,r){this.enableLoading(t);const d=JSON.stringify({line:t,quantity:e,sections:this.getSectionsToRender().map(n=>n.section),sections_url:window.location.pathname});fetch(`${routes.cart_change_url}`,{...fetchConfig(),body:d}).then(n=>n.text()).then(n=>{const s=JSON.parse(n);this.classList.toggle("is-empty",s.item_count===0);const a=document.getElementById("main-cart-footer");a&&a.classList.toggle("is-empty",s.item_count===0),this.getSectionsToRender().forEach(i=>{const l=document.getElementById(i.id).querySelector(i.selector)||document.getElementById(i.id);l.innerHTML=this.getSectionInnerHTML(s.sections[i.section],i.selector)}),this.updateLiveRegions(t,s.item_count);const o=document.getElementById(`CartItem-${t}`);o&&o.querySelector(`[name="${r}"]`).focus(),this.disableLoading()}).catch(()=>{this.querySelectorAll(".loading-overlay").forEach(n=>n.classList.add("hidden")),document.getElementById("cart-errors").textContent=window.cartStrings.error,this.disableLoading()})}updateLiveRegions(t,e){this.currentItemCount===e&&(document.getElementById(`Line-item-error-${t}`).querySelector(".cart-item__error-text").innerHTML=window.cartStrings.quantityError.replace("[quantity]",document.getElementById(`Quantity-${t}`).value)),this.currentItemCount=e,this.lineItemStatusElement.setAttribute("aria-hidden",!0);const r=document.getElementById("cart-live-region-text");r.setAttribute("aria-hidden",!1),setTimeout(()=>{r.setAttribute("aria-hidden",!0)},1e3)}getSectionInnerHTML(t,e){return new DOMParser().parseFromString(t,"text/html").querySelector(e).innerHTML}enableLoading(t){document.getElementById("main-cart-items").classList.add("cart__items--disabled"),this.querySelectorAll(`#CartItem-${t} .loading-overlay`).forEach(e=>e.classList.remove("hidden")),document.activeElement.blur(),this.lineItemStatusElement.setAttribute("aria-hidden",!1)}disableLoading(){document.getElementById("main-cart-items").classList.remove("cart__items--disabled")}}customElements.define("cart-items",CartItems);
//# sourceMappingURL=/s/files/1/0433/3790/8380/t/28/assets/cart.js.map?v=7258637425597212851
